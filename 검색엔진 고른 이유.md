API에 우리는 랭킹 시스템을 도입하여 날씨 및 사용자의 정보에 따라 옷을 추천해주는 시스템을 구축하기 위한 검색엔진으로 어떤것이 타당할 지 고민하다가 solr을 선택하였습니다.

검색엔진으로는 대표적으로 Apache Solr / ELasticsearch 가 있습니다.

1. 소개

1.1 Apache Solr
HTTP 요청을 통해 Lucene의 모든 검색 기능을 제공하는 Lucene 위에 구축된 오픈 소스 검색 서버입니다. 거의 10 년 반 동안 사용되어 광범위한 사용자 커뮤니티가있는 성숙한 제품입니다. Solr은 분산 전체 텍스트 검색, 패싯, 거의 실시간 인덱싱, 고가용성, NoSQL 기능, Hadoop과 같은 빅 데이터 도구와의 통합, Word 및 PDF와 같은 서식 있는 텍스트 문서 처리 기능과 같은 강력한 기능을 제공합니다.

1.2 Elasticsearch
Apache Lucene 위에 구축 된 오픈 소스 검색 엔진입니다. ELK Stack, including Logstash와 Kibana. RESTful API를 사용하여 Lucene의 강력한 인덱싱 및 검색 기능을 확장하고 인덱스 및 샤드 개념을 사용하여 여러 서버에 데이터 배포를 보관합니다. Elasticsearch는 완전히 JSON을 기반으로 하며 time series 및 NoSQL 데이터에 적합합니다. 이 도구는 Solr보다 훨씬 젊지 만 기능이 풍부한 사용 사례로 인해 많은 인기를 얻었습니다. 주요 기능 중 일부에는 분산 전체 텍스트 분산 검색, 고가용성, 강력한 쿼리 DSL, 다중 테넌트, 지역 검색 및 수평 크기 조정이 포함됩니다.
2. 인덱싱 및 검색 방식
Solr 과 Elasticsearch는 모두 Lucene에서 인덱스를 작성함.
허나 샤딩과 복제 및 다른 기능에서도 차이가 있기에 파일과 아키텍처에도 차이가 있음

2.1 데이터 소스 수집 방식
Solr은 요청 처리기를 사용하여 XML 파일 , CSV 파일, 데이터베이스, Microsoft Word 문서 및 PDF에서 데이터를 수집함 apache tika 라이브러리르 지원하고 이걸 통해 천 개 이상의 파일 형식에서 추출 및 인덱싱을 지원함

Elasticsearch 는 완전히 JSON 기반임. Beats 제품군 및 Logstash를 사용하여 여러 소스의 데이터 수집을 지원함

2.2 검색 기능
예전 Solr 버전은 표준 쿼리 파서에 의존해야 했지만 이제는 JSON 기반 쿼리 DSL도 지원함. Solr의 표준 쿼리 파서를 사용하면 사용자가 다양한 구조화 된 쿼리를 만들 수 있지만 이러한 쿼리를 작성하는 동안 구문 오류가 발생할 가능성이 있음.
그럼에도 불구하고 Elastic search에서는 사용할 수 없는 매우 복잡한 검색 쿼리를 작성할 수 있으며 검색, 패싯, 강조 표시, 자동 완성 및 지역 검색과 같은 좋은 기능을 제공하는 Velocity Search라는 샘플 검색 UI가 포함되어 있습니다.
		
Elasticsearch의 DSL은 네이티브입니다. Elastic search의 집계 프레임워크는 더 나은 캐싱으로 API의 집계 쿼리를 통해 강력함. 최신 릴리스의 툴을 사용하면 메모리 설치 공간을 보다 효율적으로 관리할 수 있음.

2.3 인덱싱
Elastic search는 스키마가 없기 때문에 인덱스의 스키마를 미리 정의하지 않고도 구조화되지 않은 데이터와 동적 필드를 쉽게 인덱싱할 수 있습니다. 
		
이전 버전의 Solr에서는 데이터를 인덱싱하기 전에 정의된 스키마가 필요했습니다. 그러나 Solr은 이제 필요에 따라 스키마 없는 모드 스키마 있는 모두를 모두 지원합니다.
		
두 검색 엔진 모두 동의어 기반의 사용자 지정 분석기를 지원합니다.

스키마 -> 정보를 통합하고 조직화하는 인지적 개념 또는 틀을 말하며 '도식'이라고도 한다.

3. 확장성 및 배포 방식

3.1 Clusters, Sharding, and Rebalancing
		
Elasticsearch와 SolrCloud 모두 샤딩을 지원합니다. 
그러나 Elasticsearch의 설계는 수평 확장을 염두에 두고 있기 때문에 확장 및 클러스터 관리를 더 잘 지원한다. 단점은 샤드가 생성되면 늘릴 수 없지만 축소 API를 사용하여 인덱스의 샤드를줄일수 있다는 것입니다.  SolrCloud는 기존 샤드의 추가 분할을 지원하지만 샤드의 축소는 지원하지 않습니다.

Elasticsearch의 내장 젠 디스커버리 모듈은 클러스터 조정을 처리합니다. 

SolrCloud는아파치 사육사, 추가 서비스.

샤드 또는 노드 장애가 발생하는 경우 Elasticsearch는 자체적으로 클러스터 재조정을 수행하며 수동 개입이 거의 필요하지 않다.

 SolrCloud에서 재조정은 복잡하고 관리하기 어렵다.

3.2 커뮤니티
Solr은 광범위한 오픈 소스 커뮤니티가 있다. 누구나 여전히 Solr에 기여할 수 있으며 새로운 Solr 개발자 또는 코드 커미터는 장점에 따라 선출됩니다.

Elasticsearch는 기술적으로 오픈 소스이지만 완전하지는 않다. 모든 참가자는 소스 코드에 액세스할 수 있으며 사용자는 소스 코드를 변경하고 기여할 수 있다. 그러나 최종 변경 사항은 Elasticsearch 및 기타 소프트웨어를 실행하는 회사인 Elastic의 직원으로부터 확인을 받는다

3.3 자료
Solr의 API에 대한 전반적인 적용 범위는 미미하며 좋은 기술 예제와 자습서를 찾기가 어렵다. Solr은 API 사용 사례에 대한 명확한 예제와 컨텍스트를 갖춘 매우 잘 문서화 된 제품이었다.
그러나 문서 유지 관리가 뒤쳐져 많은 사용자가 지적한 격차가 있다

Elasticsearch의 공식 웹사이트는 명확한 예제와 함께 잘 정리된 고품질 문서를 제공할 뿐만 아니라 도구의 인기 덕분에 인터넷은 책과 가이드로 넘쳐남. 지난 4년 동안 Elasticsearch는 조직을 넘어 문서를 개선했다. 또한 좋은 예제와 명확한 구성 지침을 제공함.

		
4. 결론

충분히 두 검색엔진을 비교하였음 
Elasticsearch 보다는 Solr을 사용하는게 더 좋을 거라고 생각이듬.

두 검색엔진 모두 데이터 처리 방식이나 검색 방법등 우리가 구현하려는 시스템에 둘다 타당해서
더 많은 예제와 문서가 작성되어 있는 Elasticsearch 오픈소스를 사용하려 하였지만

우리가 사용할 Basic(무료)기능들은 현재는 스탠더드(유료)로 변경되어 무료체험판이 끝나면 비용을 지불해야함 
또한 Elasticsearch 제품을 내재 한 제품으로 비즈니스를 하려면 Elastic사와 협약을 체결하지 않은 경우 OSS 버전으로만 비즈니스를 해야 함.
SI, 클라우드 서비스, 컨설팅, 기술지원, 교육 등이 모두 포함됩니다. 그래서 클라우드 서비스 사업자들 중에 Elastic 사와 파트너 협약을 하지 않고 Elastic Stack 서비스를 제공하는 사업자들은 OSS 라이센스에 속한 기능만 서비스를 해야 함.
이러한 이유로 적합하지 않다고 생각하여 Solr을 선택함.

5. 솔에서 사용할 알고리즘
Learnig to rank contrib 모듈을 사용하면 Solr에서 기계학습 순위 모델을 구성하고 실행가능!!

5.1 Re-Ranking
순위 재지정을 사용하면 일치하는 문서에 대해 간단한 쿼리를 실행한 다음 다른 복잡한 쿼리의 점수를 사용하여 상위 N개 문서의 순위를 다시 지정할 수 있습니다

5.2 Learning To Rank
정보 검색 시스템에서 순위 학습은 학습된 기계 학습모델을 사용하여 검색된 상위 N개 문서의 순위를 다시 지정하는 데 사용됩니다

5.3 Training
LTR contrib 모듈에는 여러 기능 클래스와 사용자 지정 기능에 대한 지원이 포함되어 있습니다
LRT contrib 모듈에는 [기능 변환기]가 포함되어 있어 특히 실제 순위 재지정 모델이 아직 없는 경우를 포함하여 기능추출 목적으로 기능값의 계산 및 반환을 지원합니다. 기능 선택 및 모델 학습은 오프라인 및 Solr 외부에서 수행됩니다


6. 앱에서 어떠한 역할을 할 것인가
vuex를 토대로 정리된 데이터로 solr에서 검색을 하여 앞서 설명한 알고리즘을 이용하여 사용자에게 원하는 값을 줄 수 있도록 도와주는 역할을 함 

7. 라이센스

Apache License 2.0 












